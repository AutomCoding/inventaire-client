#!/usr/bin/env bash

echo "need to update postinstall"

# set browser.fs=false to work around parcel-bundler "Cannot statically evaluate fs argument" issue
# see https://github.com/parcel-bundler/parcel/pull/523#issue-161973498
disable_browser_fs(){
  cat $1 | jq '.browser.fs = false' > $1.fixed
  mv $1.fixed $1
}

disable_browser_fs node_modules/handlebars/package.json

# set -eu

# If public/js/app.js already exist, assume that it's a re-install
# and that all the following isn't needed
# [ -e public/js/app.js ] && exit 0

# mkdir -p ./vendor/js ./vendor/css ./public/sitemaps ./public/json ./public/js ./public/css
# ./scripts/install_external_modules
# ./scripts/update_mentions.js

# ./scripts/build_i18n

# need to build once to make the public folder available
# ./node_modules/brunch/bin/brunch build
