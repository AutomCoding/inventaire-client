#!/usr/bin/env zsh

# If public/js/app.js already exist, assume that it's a re-install
# and that all the following isn't needed
[ -e public/js/app.js ] && exit 0

./scripts/slim_packages.coffee
mkdir -p ./vendor/js ./vendor/css ./public/sitemaps ./public/json
./scripts/install_external_js_modules
./scripts/update_mentions.coffee

bower install

npm run patches
./scripts/mv_font_awesome_fonts
./scripts/mv_moment_locales

# need to build once to make the public folder available
./node_modules/brunch/bin/brunch build

git clone -b i18n https://github.com/inventaire/inventaire-client.git ./public/i18n
mkdir -p ./server/lib/emails/i18n/dist
./scripts/update_i18n_all
